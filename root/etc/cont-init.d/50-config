#!/usr/bin/with-contenv bash

# make our folders
mkdir -p /config/.config/gPodder

# set webserver port on first install
if [ ! -f /config/.config/gPodder/server-config.txt ]; then
  echo "port 8080" > /config/.config/gPodder/server-config.txt
fi


# Resolve freerdp directory plugins issues
if [ ! -f /usr/lib/x86_64-linux-gnu/freerdp/guacsnd-client.so ]; then
  ln -sv /usr/local/lib/freerdp/guacsnd-client.so /usr/lib/x86_64-linux-gnu/freerdp
if [ ! -f /usr/lib/x86_64-linux-gnu/freerdp/libguac.so ]; then
  ln -sv /usr/local/lib/freerdp/libguac.so /usr/lib/x86_64-linux-gnu/freerdp
if [ ! -f /usr/lib/x86_64-linux-gnu/freerdp/guacdr-client.so ]]; then
  ln -sv /usr/local/lib/freerdp/guacdr-client.so /usr/lib/x86_64-linux-gnu/freerdp

# permissions
chown -R abc:abc \
	/config \
	/gpodder \
	/downloads 
